{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\SFelizardo\\\\Downloads\\\\secondhome\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\SFelizardo\\\\Downloads\\\\secondhome\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\SFelizardo\\\\Downloads\\\\secondhome\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\SFelizardo\\\\Downloads\\\\secondhome\\\\src\\\\app\\\\pages\\\\admin\\\\partner\\\\lead-contacts\\\\partner-lead-contact.js\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { listAllLeadContacts as _listAllLeadContacts, updateLeadContact as _updateLeadContact } from \"../../../../redux/actions/lead-contact-actions\";\nimport { useDispatch } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { notifyUser } from \"../../../../services/notification-service\";\nimport { List, Divider, Row, Col, Button, PageHeader, Table, Tag, Space, Breadcrumb, Card, Descriptions, Form, Select, Input, Tooltip } from \"antd\";\nimport { compose } from \"redux\";\nimport { EditOutlined } from \"@ant-design/icons\";\nimport { data } from \"jquery\";\nimport { humanize } from \"../../../../helpers/string-helper\";\nimport { loadCurrentLoggedInUser as _loadCurrentLoggedInUser, updateUser as _updateUser } from \"../../../../redux/actions/user-actions\";\nimport UploadDocuments from \"../../../../components/upload-documents\";\nimport Config from \"../../../../config\";\nimport fileAPI from \"../../../../redux/api/file-api\";\nimport { update } from \"lodash\";\nimport UserService from \"../../../../services/user-service\";\n\nvar PartnersLeadContact = function PartnersLeadContact(_ref) {\n  var leadContactList = _ref.leadContactList,\n      leadContactListLoading = _ref.leadContactListLoading,\n      currentLoggedInUser = _ref.currentLoggedInUser,\n      userUpdated = _ref.userUpdated;\n  var dispatch = useDispatch();\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      documentList = _useState2[0],\n      setdDocumentList = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var user = UserService.getAdminUser();\n\n  var _useState5 = useState({\n    \"user_created\": {\n      \"_eq\": user.id\n    }\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      filters = _useState6[0],\n      setFilters = _useState6[1];\n\n  var columns = [{\n    title: \"Name\",\n    dataIndex: \"name\",\n    key: \"name\",\n    render: function render(text, leadContact) {\n      return /*#__PURE__*/React.createElement(Space, {\n        size: \"middle\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        className: \"cap-letter\",\n        to: \"/admin/partners/community/lead-contacts/\".concat(leadContact.key),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 21\n        }\n      }, text));\n    }\n  }, {\n    title: \"Community\",\n    dataIndex: \"home_name\",\n    key: \"home_name\",\n    render: function render(homes, leadContact) {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, homes.map(function (item, index) {\n        return item.homes_id && item.homes_id.name;\n      }).join(', ')) // <Space size=\"middle\">\n      //     <Link to={`/admin/partners/communities/${leadContact.home_id}`}>{text}</Link>\n      // </Space>\n      ;\n    }\n  }, {\n    title: \"Email\",\n    dataIndex: \"email\",\n    key: \"email\",\n    render: function render(text, leadContact) {\n      return /*#__PURE__*/React.createElement(Space, {\n        size: \"middle\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 44\n        }\n      }, text);\n    }\n  }, {\n    title: \"Cell\",\n    dataIndex: \"phone\",\n    key: \"phone\",\n    render: function render(text, leadContact) {\n      return /*#__PURE__*/React.createElement(Space, {\n        size: \"middle\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 44\n        }\n      }, formatNumber(text));\n    }\n  }, {\n    title: \"Job Title\",\n    dataIndex: \"job_title\",\n    key: \"job_title\",\n    render: function render(text) {\n      return /*#__PURE__*/React.createElement(Space, {\n        size: \"middle\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 31\n        }\n      }, \"\".concat(text));\n    }\n  }, // {\n  //     title: \"Status\",\n  //     dataIndex: \"status\",\n  //     key: \"status\",\n  //     render: (text) => (\n  //         <Space>\n  //             <Tag color={text == \"published\" ? \"green\" : \"red\"}>\n  //                 {humanize(text)}\n  //             </Tag>\n  //         </Space>\n  //     ),\n  // },\n  {\n    title: \"Action\",\n    key: \"action\",\n    render: function render(text, home) {\n      return /*#__PURE__*/React.createElement(Space, {\n        size: \"middle\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Tooltip, {\n        title: \"Edit\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: \"/admin/partners/community/lead-contacts/\".concat(home.key),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(EditOutlined, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 29\n        }\n      }))));\n    }\n  }];\n  useEffect(function () {\n    if (!currentLoggedInUser || !currentLoggedInUser.contract || !currentLoggedInUser.contract.id || userUpdated) {\n      dispatch(_loadCurrentLoggedInUser({\n        fields: \"*,contract.*\"\n      }));\n    }\n\n    setdDocumentList(currentLoggedInUser && currentLoggedInUser.contract ? [{\n      uid: currentLoggedInUser.contract.id,\n      id: currentLoggedInUser.contract.id,\n      status: \"done\",\n      url: \"\".concat(Config.API, \"/assets/\").concat(currentLoggedInUser.contract.id),\n      name: currentLoggedInUser.contract.filename_download\n    }] : []);\n    dispatch(_listAllLeadContacts({\n      'fields': [\"*\", \"home.*,homes.homes_id.*\"],\n      filter: filters\n    }));\n\n    if (userUpdated) {\n      setLoading(false);\n    }\n\n    return function () {\n      console.log(\"Communities Unmounting\");\n    };\n  }, [currentLoggedInUser, userUpdated]);\n\n  var handleSave = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var _contract;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _contract = null;\n              _context.next = 4;\n              return getFilesArray(documentList);\n\n            case 4:\n              _contract = _context.sent;\n              values.contract = _contract;\n              _context.next = 8;\n              return dispatch(_updateUser(currentLoggedInUser.id, values));\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSave(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handelDocumentChange = function handelDocumentChange(_ref3) {\n    var fileList = _ref3.fileList;\n    setdDocumentList(fileList);\n  };\n\n  var getFilesArray = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(fileList) {\n      var file, response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!fileList.length) {\n                _context2.next = 10;\n                break;\n              }\n\n              file = fileList[0];\n\n              if (!file.id) {\n                _context2.next = 6;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", file.id);\n\n            case 6:\n              _context2.next = 8;\n              return fileAPI.uploadFile(file);\n\n            case 8:\n              response = _context2.sent;\n              return _context2.abrupt(\"return\", response.data.id);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getFilesArray(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var formatNumber = function formatNumber(e) {\n    if (e) {\n      var x = e.toString().replace(/\\D/g, '').match(/(\\d{0,3})(\\d{0,3})(\\d{0,4})/);\n      return !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Breadcrumb, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/admin\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }, \"Home\")), /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/admin/partners\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 21\n    }\n  }, \"Partners\")), /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/admin/partner/overview\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 34\n    }\n  }, humanize(user.first_name), \" \", humanize(user.last_name))), /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  }, \"Lead Contacts\"))), /*#__PURE__*/React.createElement(Row, {\n    gutter: 30,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 24,\n    sm: 24,\n    md: 24,\n    lg: 24,\n    xl: 24,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    title: \"Lead Contacts\",\n    extra: /*#__PURE__*/React.createElement(Button, {\n      href: \"/dashboard/admin/partners/community/lead-contacts/add\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 29\n      }\n    }, \"Add Lead Contact\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    columns: columns,\n    loading: leadContactListLoading,\n    dataSource: leadContactList.map(function (_ref5) {\n      var first_name = _ref5.first_name,\n          last_name = _ref5.last_name,\n          phone = _ref5.phone,\n          email = _ref5.email,\n          id = _ref5.id,\n          job_title = _ref5.job_title,\n          homes = _ref5.homes;\n      return {\n        name: first_name + \" \" + last_name,\n        phone: phone,\n        email: email,\n        key: id,\n        // status,\n        job_title: job_title,\n        home_name: homes && homes // home_id: home.id\n\n      };\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  })))));\n};\n\nfunction mapStateToProps(state) {\n  return {\n    leadContactList: state.leadContact.leadContactList,\n    leadContactListLoading: state.leadContact.leadContactListLoading,\n    currentLoggedInUser: state.user.currentLoggedInUser,\n    userUpdated: state.user.userUpdated\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    listAllLeadContacts: function listAllLeadContacts() {\n      return dispatch(_listAllLeadContacts());\n    },\n    updateLeadContact: function updateLeadContact() {\n      return dispatch(_updateLeadContact());\n    },\n    loadCurrentLoggedInUser: function loadCurrentLoggedInUser() {\n      return dispatch(_loadCurrentLoggedInUser());\n    },\n    updateUser: function updateUser() {\n      return dispatch(_updateUser());\n    }\n  };\n}\n\nexport default compose(connect(mapStateToProps, mapDispatchToProps))(PartnersLeadContact);","map":{"version":3,"sources":["C:/Users/SFelizardo/Downloads/secondhome/src/app/pages/admin/partner/lead-contacts/partner-lead-contact.js"],"names":["React","useEffect","useState","connect","listAllLeadContacts","updateLeadContact","useDispatch","Link","notifyUser","List","Divider","Row","Col","Button","PageHeader","Table","Tag","Space","Breadcrumb","Card","Descriptions","Form","Select","Input","Tooltip","compose","EditOutlined","data","humanize","loadCurrentLoggedInUser","updateUser","UploadDocuments","Config","fileAPI","update","UserService","PartnersLeadContact","leadContactList","leadContactListLoading","currentLoggedInUser","userUpdated","dispatch","useForm","form","documentList","setdDocumentList","loading","setLoading","user","getAdminUser","id","filters","setFilters","columns","title","dataIndex","key","render","text","leadContact","homes","map","item","index","homes_id","name","join","formatNumber","home","contract","fields","uid","status","url","API","filename_download","filter","console","log","handleSave","values","_contract","getFilesArray","handelDocumentChange","fileList","length","file","uploadFile","response","e","x","toString","replace","match","first_name","last_name","phone","email","job_title","home_name","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n    listAllLeadContacts,\r\n    updateLeadContact,\r\n} from \"../../../../redux/actions/lead-contact-actions\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport { notifyUser } from \"../../../../services/notification-service\";\r\nimport { List, Divider, Row, Col, Button, PageHeader, Table, Tag, Space, Breadcrumb, Card, Descriptions, Form, Select, Input, Tooltip, } from \"antd\";\r\nimport { compose } from \"redux\";\r\nimport { EditOutlined } from \"@ant-design/icons\";\r\nimport { data } from \"jquery\";\r\nimport { humanize } from \"../../../../helpers/string-helper\";\r\nimport { loadCurrentLoggedInUser, updateUser, } from \"../../../../redux/actions/user-actions\";\r\nimport UploadDocuments from \"../../../../components/upload-documents\";\r\nimport Config from \"../../../../config\";\r\nimport fileAPI from \"../../../../redux/api/file-api\";\r\nimport { update } from \"lodash\";\r\nimport UserService from \"../../../../services/user-service\";\r\n\r\nconst PartnersLeadContact = ({ leadContactList, leadContactListLoading, currentLoggedInUser, userUpdated, }) => {\r\n\r\n    const dispatch = useDispatch();\r\n    const [form] = Form.useForm();\r\n    const [documentList, setdDocumentList] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n\r\n    const user = UserService.getAdminUser();\r\n\r\n    const [filters, setFilters] = useState({\r\n\r\n        \"user_created\": {\r\n            \"_eq\": user.id\r\n        }\r\n\r\n    });\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Name\",\r\n            dataIndex: \"name\",\r\n            key: \"name\",\r\n            render: (text, leadContact) => (\r\n                <Space size=\"middle\">\r\n                    <Link className=\"cap-letter\" to={`/admin/partners/community/lead-contacts/${leadContact.key}`}>{text}</Link>\r\n                </Space>\r\n            ),\r\n        },\r\n        {\r\n            title: \"Community\",\r\n            dataIndex: \"home_name\",\r\n            key: \"home_name\",\r\n            render: (homes, leadContact) => (\r\n                <>\r\n                    {homes.map((item, index) => {\r\n                        return item.homes_id && item.homes_id.name\r\n                    }).join(', ')}\r\n                </>\r\n                // <Space size=\"middle\">\r\n                //     <Link to={`/admin/partners/communities/${leadContact.home_id}`}>{text}</Link>\r\n                // </Space>\r\n            ),\r\n        },\r\n        {\r\n            title: \"Email\",\r\n            dataIndex: \"email\",\r\n            key: \"email\",\r\n            render: (text, leadContact) => <Space size=\"middle\">{text}</Space>,\r\n        },\r\n\r\n        {\r\n            title: \"Cell\",\r\n            dataIndex: \"phone\",\r\n            key: \"phone\",\r\n            render: (text, leadContact) => <Space size=\"middle\">{formatNumber(text)}</Space>,\r\n        },\r\n\r\n        {\r\n            title: \"Job Title\",\r\n            dataIndex: \"job_title\",\r\n            key: \"job_title\",\r\n            render: (text) => <Space size=\"middle\">{`${text}`}</Space>,\r\n        },\r\n\r\n        // {\r\n        //     title: \"Status\",\r\n        //     dataIndex: \"status\",\r\n        //     key: \"status\",\r\n        //     render: (text) => (\r\n        //         <Space>\r\n        //             <Tag color={text == \"published\" ? \"green\" : \"red\"}>\r\n        //                 {humanize(text)}\r\n        //             </Tag>\r\n        //         </Space>\r\n        //     ),\r\n        // },\r\n        {\r\n            title: \"Action\",\r\n            key: \"action\",\r\n            render: (text, home) => (\r\n                <Space size=\"middle\">\r\n                    <Tooltip title=\"Edit\">\r\n                        <Link to={`/admin/partners/community/lead-contacts/${home.key}`}>\r\n                            <EditOutlined />\r\n                        </Link>\r\n                    </Tooltip>\r\n\r\n                </Space>\r\n            ),\r\n        },\r\n    ];\r\n\r\n    useEffect(() => {\r\n        if (!currentLoggedInUser || !currentLoggedInUser.contract || !currentLoggedInUser.contract.id || userUpdated) {\r\n\r\n            dispatch(loadCurrentLoggedInUser({ fields: \"*,contract.*\" }));\r\n        }\r\n        setdDocumentList(\r\n            currentLoggedInUser && currentLoggedInUser.contract\r\n                ? [\r\n                    {\r\n                        uid: currentLoggedInUser.contract.id,\r\n                        id: currentLoggedInUser.contract.id,\r\n                        status: \"done\",\r\n                        url: `${Config.API}/assets/${currentLoggedInUser.contract.id}`,\r\n                        name: currentLoggedInUser.contract.filename_download,\r\n                    },\r\n                ]\r\n                : []\r\n        );\r\n\r\n        dispatch(listAllLeadContacts({ 'fields': [\"*\", \"home.*,homes.homes_id.*\"], filter: filters }));\r\n        if (userUpdated) {\r\n            setLoading(false);\r\n        }\r\n\r\n        return () => {\r\n            console.log(\"Communities Unmounting\");\r\n        };\r\n    }, [currentLoggedInUser, userUpdated]);\r\n\r\n    const handleSave = async (values) => {\r\n        setLoading(true);\r\n        var _contract = null;\r\n        _contract = await getFilesArray(documentList);\r\n        values.contract = _contract;\r\n        await dispatch(updateUser(currentLoggedInUser.id, values));\r\n\r\n        //window.location.reload();\r\n    };\r\n\r\n    const handelDocumentChange = ({ fileList }) => {\r\n        setdDocumentList(fileList);\r\n    };\r\n\r\n    const getFilesArray = async (fileList) => {\r\n        if (fileList.length) {\r\n            let file = fileList[0];\r\n            if (file.id) {\r\n                return file.id;\r\n            } else {\r\n                const response = await fileAPI.uploadFile(file);\r\n                return response.data.id;\r\n            }\r\n        }\r\n    };\r\n\r\n    const formatNumber = (e) => {\r\n        if (e) {\r\n            var x = e.toString().replace(/\\D/g, '').match(/(\\d{0,3})(\\d{0,3})(\\d{0,4})/);\r\n            return !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');\r\n    \r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Breadcrumb>\r\n                <Breadcrumb.Item>\r\n                    <Link to=\"/admin\">Home</Link>\r\n                </Breadcrumb.Item>\r\n                <Breadcrumb.Item>\r\n                    <Link to=\"/admin/partners\">Partners</Link>\r\n                </Breadcrumb.Item>\r\n                <Breadcrumb.Item><Link to=\"/admin/partner/overview\">{humanize(user.first_name)} {humanize(user.last_name)}</Link></Breadcrumb.Item>\r\n                <Breadcrumb.Item>\r\n                    <Link to=\"\">Lead Contacts</Link>\r\n                </Breadcrumb.Item>\r\n            </Breadcrumb>\r\n            <Row gutter={30}>\r\n\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <Card\r\n                        title=\"Lead Contacts\"\r\n                        extra={\r\n                            <Button href={\"/dashboard/admin/partners/community/lead-contacts/add\"}>\r\n                                Add Lead Contact\r\n                            </Button>\r\n                        }\r\n                    >\r\n                        <Table\r\n                            columns={columns}\r\n                            loading={leadContactListLoading}\r\n                            dataSource={leadContactList.map(\r\n                                ({\r\n                                    first_name,\r\n                                    last_name,\r\n                                    phone,\r\n                                    email,\r\n                                    // status,\r\n                                    id,\r\n                                    job_title,\r\n                                    homes\r\n\r\n                                }) => {\r\n                                    return {\r\n                                        name: first_name + \" \" + last_name,\r\n                                        phone,\r\n                                        email,\r\n                                        key: id,\r\n                                        // status,\r\n                                        job_title,\r\n                                        home_name: homes && homes,\r\n                                        // home_id: home.id\r\n                                    };\r\n                                }\r\n                            )}\r\n                        />\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </>\r\n    );\r\n};\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        leadContactList: state.leadContact.leadContactList,\r\n        leadContactListLoading: state.leadContact.leadContactListLoading,\r\n        currentLoggedInUser: state.user.currentLoggedInUser,\r\n        userUpdated: state.user.userUpdated,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        listAllLeadContacts: () => dispatch(listAllLeadContacts()),\r\n        updateLeadContact: () => dispatch(updateLeadContact()),\r\n        loadCurrentLoggedInUser: () => dispatch(loadCurrentLoggedInUser()),\r\n        updateUser: () => dispatch(updateUser()),\r\n    };\r\n}\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps))(\r\n    PartnersLeadContact\r\n);\r\n"]},"metadata":{},"sourceType":"module"}