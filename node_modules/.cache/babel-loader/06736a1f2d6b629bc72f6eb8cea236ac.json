{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\SFelizardo\\\\Desktop\\\\Projects\\\\secondhome\\\\second-home-referrals\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\SFelizardo\\\\Desktop\\\\Projects\\\\secondhome\\\\second-home-referrals\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\SFelizardo\\\\Desktop\\\\Projects\\\\secondhome\\\\second-home-referrals\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\SFelizardo\\\\Desktop\\\\Projects\\\\secondhome\\\\second-home-referrals\\\\src\\\\app\\\\pages\\\\global-search\\\\map-view.jsx\";\n\nimport React, { useState } from \"react\";\nimport { GoogleApiWrapper, Map, Marker } from \"google-maps-react\";\nimport { Card, Divider, Button, Modal, Input, Form, Spin, List, Typography, Checkbox, Popconfirm } from \"antd\";\nimport { CloseOutlined, EyeOutlined } from \"@ant-design/icons\";\nimport Config from \"../../config\";\nimport { humanize } from \"../../helpers/string-helper\";\nimport userService from \"../../services/user-service\";\nimport leadApi from \"../../redux/api/lead-api\";\nimport { notifyUser } from \"../../services/notification-service\";\nimport moment from \"moment\";\nimport InfoWindowEx from \"../../components/infoWindowEx\"; // import HeartImg from \"../../assets/images/heart.svg\";\n\nimport HeartImg from \"../../assets/images/new-map-icon.png\";\nimport defaultImage from \"../../assets/images/second-home-facility-default.jpg\";\nvar Meta = Card.Meta;\nvar Text = Typography.Text,\n    Title = Typography.Title;\n\nvar MapView = function MapView(_ref) {\n  var homes = _ref.homes,\n      google = _ref.google,\n      client = _ref.client,\n      sendLead = _ref.sendLead;\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      home = _React$useState2[0],\n      setHome = _React$useState2[1];\n\n  var _React$useState3 = React.useState(null),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      lead = _React$useState4[0],\n      setLead = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      infoVisible = _React$useState6[0],\n      setInfoVisible = _React$useState6[1];\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      activeMarker = _React$useState8[0],\n      setActiveMarker = _React$useState8[1];\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isDetailModalVisible = _useState2[0],\n      setIsDetailModalVisible = _useState2[1];\n\n  var user = userService.getAdminUser();\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      sendLeadsLoading = _useState4[0],\n      setSendLeadsLoading = _useState4[1];\n\n  var onMarkerClick = function onMarkerClick(marker, location, lead) {\n    setHome(location);\n    setLead(lead);\n    setInfoVisible(true);\n    setActiveMarker(marker);\n  };\n\n  var closeInfo = function closeInfo(e) {\n    setHome(null);\n    setInfoVisible(false);\n    setActiveMarker(null);\n  };\n\n  function mapConfig() {\n    var points = [];\n\n    if (homes !== null) {\n      homes.map(function (_ref2) {\n        var geo = _ref2.geo;\n        points.push(geo);\n      });\n    }\n\n    return points;\n  }\n\n  var mapPoints = mapConfig();\n  var initialMapCenter = mapPoints[0];\n  var mapBounds = new google.maps.LatLngBounds();\n\n  for (var i = 0; i < mapPoints.length; i++) {\n    mapBounds.extend(mapPoints[i]);\n  }\n\n  var sendLeads = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(include_client_phone, Id) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setSendLeadsLoading(true);\n              sendLead(include_client_phone, Id);\n              closeInfo(Id);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function sendLeads(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var getMaxRoomCost = function getMaxRoomCost() {\n    if (home && home.rooms.length) {\n      return Math.max.apply(Math, home.rooms.map(function (room) {\n        return room.base_rate;\n      }));\n    } else {\n      return false;\n    }\n  };\n\n  var getMinRoomCost = function getMinRoomCost() {\n    if (home && home.rooms.length) {\n      return Math.min.apply(Math, home.rooms.map(function (room) {\n        return room.base_rate;\n      }));\n    } else {\n      return false;\n    }\n  };\n\n  var mapModalContent = function mapModalContent(Item) {\n    if (Item !== null) {\n      return Object.entries(Item).map(function (Key, Value) {\n        var content;\n\n        if (Key[1] !== null && Key[1] !== \"\" && Key[0] !== \"user_created\" && Key[0] !== \"geo\" && Key[0] !== \"rooms\") {\n          content = /*#__PURE__*/React.createElement(\"div\", {\n            key: Value,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 25\n            }\n          }, /*#__PURE__*/React.createElement(Text, {\n            strong: true,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 29\n            }\n          }, humanize(Key[0]), \" :\"), /*#__PURE__*/React.createElement(Text, {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 29\n            }\n          }, Key[0] === \"date_created\" ? moment(Key[1]).format(\"MM-DD-YYYY\") : /*#__PURE__*/React.createElement(React.Fragment, null, typeof Key[1] !== \"object\" ? Key[1] : Key[1].length && Key[1].map(function (item) {\n            return humanize(item.toString());\n          }).join(\", \"))));\n          return content;\n        }\n      });\n    }\n  };\n\n  var showDetailModal = function showDetailModal() {\n    setIsDetailModalVisible(!isDetailModalVisible);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"scroll_remove\",\n    style: {\n      position: \"relative\",\n      height: \"calc(100vh - 66px)\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Map, {\n    style: {},\n    zoom: 7,\n    initialCenter: initialMapCenter,\n    google: google,\n    bounds: mapBounds,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, homes.map(function (home, index) {\n    var leadData = false;\n\n    if (client && client.leads) {\n      client.leads.map(function (lead) {\n        if (home.id == lead.home) {\n          leadData = lead;\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(Marker, {\n      key: index,\n      name: \"Current location\",\n      icon: {\n        url: HeartImg,\n        anchor: new google.maps.Point(32, 45),\n        scaledSize: new google.maps.Size(32, 45)\n      },\n      position: {\n        lat: home.geo.lat,\n        lng: home.geo.lng\n      },\n      onClick: function onClick(_, marker) {\n        return onMarkerClick(marker, home, leadData);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 25\n      }\n    });\n  }), /*#__PURE__*/React.createElement(InfoWindowEx, {\n    visible: infoVisible,\n    marker: activeMarker,\n    onClose: function onClose(e) {\n      return closeInfo(e);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: \"100%\",\n      height: \"200px\",\n      backgroundPosition: \"center center\",\n      backgroundRepeat: \"no-repeat\"\n    },\n    src: home && home.image ? \"\".concat(Config.API, \"/assets/\").concat(home.image) : defaultImage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map_card\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Meta // title={home && home.name}\n  , {\n    description: /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-details\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"housing-type\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 41\n      }\n    }, home && home.care_offered && home.care_offered.map(function (text, index) {\n      return /*#__PURE__*/React.createElement(\"span\", {\n        key: index,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 53\n        }\n      }, text === \"continuing_care_retirement_community\" ? text.toUpperCase() : humanize(text));\n    })), /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 41\n      }\n    }, getMinRoomCost() !== false && \"$\".concat(getMinRoomCost(), \" - $\").concat(getMaxRoomCost()))),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 29\n    }\n  }), home ? /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/dashboard/home-detail/\".concat(home.id),\n    target: \"_blank\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 37\n    }\n  }, \"Learn More\") : \"\"))), /*#__PURE__*/React.createElement(Modal, {\n    footer: null,\n    title: \"Details\",\n    visible: isDetailModalVisible,\n    onOk: showDetailModal,\n    onCancel: showDetailModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 21\n    }\n  }, mapModalContent(home)))));\n};\n\nexport default GoogleApiWrapper({\n  apiKey: Config.googleMapsAPIkey\n})(MapView);","map":{"version":3,"sources":["C:/Users/SFelizardo/Desktop/Projects/secondhome/second-home-referrals/src/app/pages/global-search/map-view.jsx"],"names":["React","useState","GoogleApiWrapper","Map","Marker","Card","Divider","Button","Modal","Input","Form","Spin","List","Typography","Checkbox","Popconfirm","CloseOutlined","EyeOutlined","Config","humanize","userService","leadApi","notifyUser","moment","InfoWindowEx","HeartImg","defaultImage","Meta","Text","Title","MapView","homes","google","client","sendLead","home","setHome","lead","setLead","infoVisible","setInfoVisible","activeMarker","setActiveMarker","isDetailModalVisible","setIsDetailModalVisible","user","getAdminUser","sendLeadsLoading","setSendLeadsLoading","onMarkerClick","marker","location","closeInfo","e","mapConfig","points","map","geo","push","mapPoints","initialMapCenter","mapBounds","maps","LatLngBounds","i","length","extend","sendLeads","include_client_phone","Id","getMaxRoomCost","rooms","Math","max","apply","room","base_rate","getMinRoomCost","min","mapModalContent","Item","Object","entries","Key","Value","content","format","item","toString","join","showDetailModal","position","height","index","leadData","leads","id","url","anchor","Point","scaledSize","Size","lat","lng","_","width","backgroundPosition","backgroundRepeat","image","API","care_offered","text","toUpperCase","apiKey","googleMapsAPIkey"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { GoogleApiWrapper, Map, Marker } from \"google-maps-react\";\r\nimport {\r\n    Card,\r\n    Divider,\r\n    Button,\r\n    Modal,\r\n    Input,\r\n    Form,\r\n    Spin,\r\n    List,\r\n    Typography,\r\n    Checkbox,\r\n    Popconfirm,\r\n} from \"antd\";\r\nimport { CloseOutlined, EyeOutlined } from \"@ant-design/icons\";\r\nimport Config from \"../../config\";\r\nimport { humanize } from \"../../helpers/string-helper\";\r\nimport userService from \"../../services/user-service\";\r\nimport leadApi from \"../../redux/api/lead-api\";\r\nimport { notifyUser } from \"../../services/notification-service\";\r\nimport moment from \"moment\";\r\nimport InfoWindowEx from \"../../components/infoWindowEx\";\r\n// import HeartImg from \"../../assets/images/heart.svg\";\r\nimport HeartImg from \"../../assets/images/new-map-icon.png\";\r\nimport defaultImage from \"../../assets/images/second-home-facility-default.jpg\";\r\nconst { Meta } = Card;\r\nconst { Text, Title } = Typography;\r\n\r\nconst MapView = ({ homes, google, client, sendLead }) => {\r\n    const [home, setHome] = React.useState(null);\r\n    const [lead, setLead] = React.useState(null);\r\n    const [infoVisible, setInfoVisible] = React.useState(false);\r\n    const [activeMarker, setActiveMarker] = React.useState(null);\r\n    const [isDetailModalVisible, setIsDetailModalVisible] = useState(false);\r\n    const user = userService.getAdminUser();\r\n\r\n    const [sendLeadsLoading, setSendLeadsLoading] = useState(false);\r\n\r\n    const onMarkerClick = (marker, location, lead) => {\r\n        setHome(location);\r\n        setLead(lead);\r\n        setInfoVisible(true);\r\n        setActiveMarker(marker);\r\n    };\r\n\r\n    const closeInfo = (e) => {\r\n        setHome(null);\r\n        setInfoVisible(false);\r\n        setActiveMarker(null);\r\n    };\r\n\r\n    function mapConfig() {\r\n        const points = [];\r\n        if (homes !== null) {\r\n            homes.map(({ geo }) => {\r\n                points.push(geo);\r\n            });\r\n        }\r\n        return points;\r\n    }\r\n    const mapPoints = mapConfig();\r\n    const initialMapCenter = mapPoints[0];\r\n    let mapBounds = new google.maps.LatLngBounds();\r\n    for (let i = 0; i < mapPoints.length; i++) {\r\n        mapBounds.extend(mapPoints[i]);\r\n    }\r\n\r\n    const sendLeads = async (include_client_phone, Id) => {\r\n        setSendLeadsLoading(true);\r\n        sendLead(include_client_phone, Id);\r\n        closeInfo(Id);\r\n    };\r\n    const getMaxRoomCost = () => {\r\n        if (home && home.rooms.length) {\r\n            return Math.max.apply(\r\n                Math,\r\n                home.rooms.map(function (room) {\r\n                    return room.base_rate;\r\n                })\r\n            );\r\n        } else {\r\n            return false;\r\n        }\r\n    };\r\n\r\n    const getMinRoomCost = () => {\r\n        if (home && home.rooms.length) {\r\n            return Math.min.apply(\r\n                Math,\r\n                home.rooms.map(function (room) {\r\n                    return room.base_rate;\r\n                })\r\n            );\r\n        } else {\r\n            return false;\r\n        }\r\n    };\r\n\r\n    const mapModalContent = (Item) => {\r\n        if (Item !== null) {\r\n            return Object.entries(Item).map((Key, Value) => {\r\n                let content;\r\n                if (\r\n                    Key[1] !== null &&\r\n                    Key[1] !== \"\" &&\r\n                    Key[0] !== \"user_created\" &&\r\n                    Key[0] !== \"geo\" &&\r\n                    Key[0] !== \"rooms\"\r\n                ) {\r\n                    content = (\r\n                        <div key={Value}>\r\n                            <Text strong>{humanize(Key[0])} :</Text>\r\n                            <Text>\r\n                                {Key[0] === \"date_created\" ? (\r\n                                    moment(Key[1]).format(\"MM-DD-YYYY\")\r\n                                ) : (\r\n                                    <>\r\n                                        {typeof Key[1] !== \"object\"\r\n                                            ? Key[1]\r\n                                            : Key[1].length &&\r\n                                            Key[1]\r\n                                                .map((item) => {\r\n                                                    return humanize(item.toString());\r\n                                                })\r\n                                                .join(\", \")}\r\n                                    </>\r\n                                )}\r\n                            </Text>\r\n                        </div>\r\n                    );\r\n                    return content;\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    const showDetailModal = () => {\r\n        setIsDetailModalVisible(!isDetailModalVisible);\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"scroll_remove\"\r\n            style={{\r\n                position: \"relative\",\r\n                height: \"calc(100vh - 66px)\",\r\n            }}\r\n        >\r\n            <Map\r\n                style={{}}\r\n                zoom={7}\r\n                initialCenter={initialMapCenter}\r\n                google={google}\r\n                bounds={mapBounds}\r\n            >\r\n                {homes.map(function (home, index) {\r\n                    var leadData = false;\r\n                    if (client && client.leads) {\r\n                        client.leads.map((lead) => {\r\n                            if (home.id == lead.home) {\r\n                                leadData = lead;\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    return (\r\n                        <Marker\r\n                            key={index}\r\n                            name={\"Current location\"}\r\n                            icon={{\r\n                                url: HeartImg,\r\n                                anchor: new google.maps.Point(32, 45),\r\n                                scaledSize: new google.maps.Size(32, 45),\r\n                            }}\r\n                            position={{\r\n                                lat: home.geo.lat,\r\n                                lng: home.geo.lng,\r\n                            }}\r\n                            onClick={(_, marker) => onMarkerClick(marker, home, leadData)}\r\n                        />\r\n                    );\r\n                })}\r\n\r\n                <InfoWindowEx\r\n                    visible={infoVisible}\r\n                    marker={activeMarker}\r\n                    onClose={(e) => closeInfo(e)}\r\n                >\r\n                    <div>\r\n                        <img\r\n                            style={{\r\n                                width: \"100%\",\r\n                                height: \"200px\",\r\n                                backgroundPosition: \"center center\",\r\n                                backgroundRepeat: \"no-repeat\",\r\n                            }}\r\n                            src={\r\n                                home && home.image\r\n                                    ? `${Config.API}/assets/${home.image}`\r\n                                    : defaultImage\r\n                            }\r\n                        />\r\n                        <div className=\"map_card\">\r\n                            <Meta\r\n                                // title={home && home.name}\r\n                                description={\r\n                                    <div className=\"card-details\">\r\n                                        {/* {home && home.user_created && (\r\n                                            <div\r\n                                                className=\"community-name\"\r\n                                                style={{\r\n                                                    color: \"#7b7b7b\",\r\n                                                    fontSize: \"12px\",\r\n                                                    letterSpacing: \"1px\",\r\n                                                    marginTop: \"-5px\",\r\n                                                    marginBottom: \"0px\",\r\n                                                }}\r\n                                            >{`${home.user_created.first_name} ${home.user_created.last_name}`}</div>\r\n                                        )} */}\r\n                                        {/* {moment(lead.date_created)} */}\r\n                                        {/* <div>Created Date: {moment(lead.date_created).format('MM-DD-YYYY')}</div> */}\r\n                                        <div className=\"housing-type\">\r\n                                            {home &&\r\n                                                home.care_offered &&\r\n                                                home.care_offered.map((text, index) => (\r\n                                                    <span key={index}>\r\n                                                        {text === \"continuing_care_retirement_community\"\r\n                                                            ? text.toUpperCase()\r\n                                                            : humanize(text)}\r\n                                                    </span>\r\n                                                ))}\r\n                                        </div>\r\n                                        <p>\r\n                                            {/* ${getMinRoomCost()} - ${getMaxRoomCost()} / Month */}\r\n                                            {getMinRoomCost() !== false &&\r\n                                                `$${getMinRoomCost()} - $${getMaxRoomCost()}`}\r\n                                        </p>\r\n                                        {/* <p>{home && home.address_line_1}</p> */}\r\n                                    </div>\r\n                                }\r\n                            />\r\n                            {home ? <a href={`/dashboard/home-detail/${home.id}`} target=\"_blank\">Learn More</a> : \"\"}\r\n                            {/* <a onClick={showDetailModal} style={{ color: \"#1B75BC\" }}>\r\n                                <EyeOutlined />\r\n                            </a> */}\r\n                        </div>\r\n                        {/* {!lead && (\r\n                            <Button style={{ marginTop: \"10px\" }} loading={sendLeadsLoading}>\r\n                                <Popconfirm\r\n                                    title=\"Include Client's Phone?\"\r\n                                    okText=\"Yes\"\r\n                                    cancelText=\"No\"\r\n                                    onConfirm={() => sendLeads(true, home.id)}\r\n                                    onCancel={() => sendLeads(false, home.id)}\r\n                                >\r\n                                    Send Lead\r\n                                </Popconfirm>{\" \"}\r\n                            </Button>\r\n                        )} */}\r\n                    </div>\r\n                </InfoWindowEx>\r\n                <Modal\r\n                    footer={null}\r\n                    title=\"Details\"\r\n                    visible={isDetailModalVisible}\r\n                    onOk={showDetailModal}\r\n                    onCancel={showDetailModal}\r\n                >\r\n                    <div>{mapModalContent(home)}</div>\r\n                </Modal>\r\n            </Map>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default GoogleApiWrapper({\r\n    apiKey: Config.googleMapsAPIkey,\r\n})(MapView);\r\n"]},"metadata":{},"sourceType":"module"}