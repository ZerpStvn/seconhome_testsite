{"ast":null,"code":"import _toConsumableArray from \"C:\\\\xampp\\\\htdocs\\\\wordpress\\\\dashboard\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"C:\\\\xampp\\\\htdocs\\\\wordpress\\\\dashboard\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\wordpress\\\\dashboard\\\\src\\\\app\\\\pages\\\\client\\\\tour\\\\ListTour.js\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { Row, Col, Breadcrumb, Tabs, Skeleton } from \"antd\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { listAllTourLeadClients, setLeadClientListLoading } from \"../../../redux/actions/lead-client-actions\";\nimport MapViewTour from \"./MapViewTour\";\nimport FilterViewCommunity from \"../community/FilterViewCommunity\";\nimport CardViewTour from \"./CardViewTour\";\nvar TabPane = Tabs.TabPane;\n\nvar ListTour = function ListTour() {\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      switchView = _useState2[0],\n      setSwitchView = _useState2[1];\n\n  var _useState3 = useState(\"scheduled\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tourState = _useState4[0],\n      setTourState = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      leadsConfig = _useState6[0],\n      setLeadsConfig = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      filterDropdownValue = _useState8[0],\n      setFilterDropdownValue = _useState8[1];\n\n  var _useState9 = useState({}),\n      _useState10 = _slicedToArray(_useState9, 2),\n      listFilter = _useState10[0],\n      setListFilter = _useState10[1];\n\n  var dispatch = useDispatch();\n  var tourList = useSelector(function (state) {\n    return state.leadClient.leadClientTourList;\n  });\n  var loading = useSelector(function (state) {\n    return state.leadClient.leadClientListLoading;\n  });\n  var timeZone = new Date().getTimezoneOffset();\n  useEffect(function () {\n    if (loading || switchView) {\n      getAllTourList();\n    }\n\n    return function () {\n      console.log(\"Lead ClientList Unmounting\");\n    };\n  }, [loading]);\n\n  function getAllTourList() {\n    dispatch(listAllTourLeadClients({\n      fields: \"*,leads.*,leads.home.*,leads.home.rooms.*\",\n      deep: listFilter\n    }));\n  }\n\n  useEffect(function () {\n    if (tourList.length > 0) {\n      homebudget(tourList[0].leads);\n    }\n  }, [tourList]);\n\n  function callback(key) {\n    setTourState(key);\n    setListFilter({});\n    dispatch(setLeadClientListLoading(true));\n    setFilterDropdownValue('');\n  }\n\n  function switchViewHandler(value) {\n    setSwitchView(value);\n  }\n\n  function onListingFilterChange(filteredValue) {\n    var filterValue = filteredValue ? {\n      leads: {\n        _filter: {\n          home: {\n            care_offered: {\n              _contains: filteredValue\n            }\n          }\n        }\n      }\n    } : {};\n    setListFilter(filterValue);\n    setFilterDropdownValue(filteredValue);\n    dispatch(setLeadClientListLoading(true));\n  }\n\n  var getMaxRoomCost = function getMaxRoomCost(rooms) {\n    if (rooms.length) {\n      return Math.max.apply(null, rooms.length ? rooms.map(function (room) {\n        return room.base_rate ? room.base_rate : 0;\n      }) : [0]);\n    } else {\n      return 0;\n    }\n  };\n\n  var getMinRoomCost = function getMinRoomCost(rooms) {\n    if (rooms.length) {\n      return Math.min.apply(null, rooms.map(function (room) {\n        return room.base_rate ? room.base_rate : 0;\n      }));\n    } else {\n      return 0;\n    }\n  };\n\n  var homebudget = function homebudget(list) {\n    list.forEach(function (Item, index) {\n      if (Item.home) {\n        Item.max_budget = getMaxRoomCost(Item.home.rooms);\n        Item.min_budget = getMinRoomCost(Item.home.rooms);\n      }\n    });\n    setLeadsConfig(list);\n  };\n\n  var handleRateChange = function handleRateChange(value) {\n    if (value == \"low_to_high\") {\n      var NewHomes = leadsConfig.sort(function (a, b) {\n        return a.min_budget - b.min_budget;\n      });\n      setLeadsConfig(_toConsumableArray(NewHomes));\n    }\n\n    if (value == \"high_to_low\") {\n      var _NewHomes = leadsConfig.sort(function (a, b) {\n        return b.max_budget - a.max_budget;\n      });\n\n      setLeadsConfig(_toConsumableArray(_NewHomes));\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Breadcrumb, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }\n  }, \"Home\"), /*#__PURE__*/React.createElement(Breadcrumb.Item, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, \"Tours\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    defaultActiveKey: \"scheduled\",\n    onChange: callback,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TabPane, {\n    tab: \"SCHEDULED\",\n    key: \"scheduled\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }, loading ? /*#__PURE__*/React.createElement(Skeleton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 15\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(FilterViewCommunity, {\n    onSetSwitchView: switchViewHandler,\n    defaultSwitchView: switchView,\n    listFilterChange: onListingFilterChange,\n    defaultFilterListValue: filterDropdownValue,\n    handleRateChange: handleRateChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }), switchView ? /*#__PURE__*/React.createElement(Row, {\n    gutter: 16,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }, tourList && tourList.length > 0 ? tourList.map(function (item, index) {\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 25\n      }\n    }, leadsConfig.length > 0 && leadsConfig.map(function (lead) {\n      return /*#__PURE__*/React.createElement(Col, {\n        xs: 24,\n        md: 8,\n        lg: 8,\n        key: lead.id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 31\n        }\n      }, lead.tour_status === 'scheduled' && (lead.approval == \"accepted\" || lead.approval == \"pending\") && new Date(lead.scheduled_date).getTime() + -timeZone * 60000 > new Date().getTime() && lead.home !== null && /*#__PURE__*/React.createElement(CardViewTour, {\n        leadClientId: item.id,\n        leadClientName: item.name,\n        leadClientPhone: item.cell // leadID={lead.id}\n        ,\n        lead: lead,\n        homeID: lead.home.id,\n        name: lead.home.name,\n        address: lead.home.address_line_1,\n        approval: lead.approval,\n        coverImage: lead.home.image && lead.home.image,\n        liked: lead.is_liked,\n        notes: lead.notes,\n        rooms: lead.home.rooms,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 37\n        }\n      }));\n    }));\n  }) : null) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 19\n    }\n  }, tourList && tourList.length > 0 ? /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(MapViewTour, {\n    lead: leadsConfig,\n    tourType: tourState,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 25\n    }\n  })) : null))), /*#__PURE__*/React.createElement(TabPane, {\n    tab: \"COMPLETED\",\n    key: \"completed\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 11\n    }\n  }, loading ? /*#__PURE__*/React.createElement(Skeleton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 15\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FilterViewCommunity, {\n    onSetSwitchView: switchViewHandler,\n    defaultSwitchView: switchView,\n    listFilterChange: onListingFilterChange,\n    defaultFilterListValue: filterDropdownValue,\n    handleRateChange: handleRateChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 17\n    }\n  }), switchView ? /*#__PURE__*/React.createElement(Row, {\n    gutter: 16,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 19\n    }\n  }, tourList && tourList.length > 0 ? tourList.map(function (item, index) {\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 25\n      }\n    }, leadsConfig.length > 0 && leadsConfig.map(function (lead) {\n      return /*#__PURE__*/React.createElement(Col, {\n        xs: 24,\n        md: 8,\n        lg: 8,\n        key: lead.id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 31\n        }\n      }, lead.tour_status === 'scheduled' && (lead.approval == \"accepted\" || lead.approval == \"pending\") && new Date(lead.scheduled_date).getTime() + -timeZone * 60000 < new Date().getTime() && lead.home !== null && /*#__PURE__*/React.createElement(CardViewTour, {\n        leadClientId: item.id,\n        leadClientName: item.name,\n        leadClientPhone: item.cell // leadID={lead.id}\n        ,\n        lead: lead,\n        homeID: lead.home.id,\n        name: lead.home.name,\n        address: lead.home.address_line_1,\n        approval: lead.approval,\n        coverImage: lead.home.image && lead.home.image,\n        liked: lead.is_liked,\n        notes: lead.notes,\n        rooms: lead.home.rooms,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 37\n        }\n      }));\n    }));\n  }) : null) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 19\n    }\n  }, tourList && tourList.length > 0 ? /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(MapViewTour, {\n    lead: leadsConfig,\n    tourType: tourState,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 25\n    }\n  })) : null))))));\n};\n\nexport default ListTour;","map":{"version":3,"sources":["C:/xampp/htdocs/wordpress/dashboard/src/app/pages/client/tour/ListTour.js"],"names":["React","useEffect","useState","Row","Col","Breadcrumb","Tabs","Skeleton","useSelector","useDispatch","listAllTourLeadClients","setLeadClientListLoading","MapViewTour","FilterViewCommunity","CardViewTour","TabPane","ListTour","switchView","setSwitchView","tourState","setTourState","leadsConfig","setLeadsConfig","filterDropdownValue","setFilterDropdownValue","listFilter","setListFilter","dispatch","tourList","state","leadClient","leadClientTourList","loading","leadClientListLoading","timeZone","Date","getTimezoneOffset","getAllTourList","console","log","fields","deep","length","homebudget","leads","callback","key","switchViewHandler","value","onListingFilterChange","filteredValue","filterValue","_filter","home","care_offered","_contains","getMaxRoomCost","rooms","Math","max","apply","map","room","base_rate","getMinRoomCost","min","list","forEach","Item","index","max_budget","min_budget","handleRateChange","NewHomes","sort","a","b","item","lead","id","tour_status","approval","scheduled_date","getTime","name","cell","address_line_1","image","is_liked","notes"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Row, Col, Breadcrumb, Tabs, Skeleton } from \"antd\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {\r\n  listAllTourLeadClients,\r\n  setLeadClientListLoading,\r\n} from \"../../../redux/actions/lead-client-actions\";\r\n\r\nimport MapViewTour from \"./MapViewTour\";\r\nimport FilterViewCommunity from \"../community/FilterViewCommunity\";\r\nimport CardViewTour from \"./CardViewTour\";\r\n\r\nconst { TabPane } = Tabs;\r\n\r\nconst ListTour = () => {\r\n  const [switchView, setSwitchView] = useState(true);\r\n  const [tourState, setTourState] = useState(\"scheduled\");\r\n  const [leadsConfig, setLeadsConfig] = useState([]);\r\n  const [filterDropdownValue, setFilterDropdownValue] = useState(\"\");\r\n  const [listFilter, setListFilter] = useState({});\r\n  const dispatch = useDispatch();\r\n  const tourList = useSelector((state) => state.leadClient.leadClientTourList);\r\n  const loading = useSelector(\r\n    (state) => state.leadClient.leadClientListLoading\r\n  );\r\n  const timeZone = new Date().getTimezoneOffset();\r\n  useEffect(() => {\r\n    if (loading || switchView) {\r\n      getAllTourList();\r\n    }\r\n    return () => {\r\n      console.log(\"Lead ClientList Unmounting\");\r\n    };\r\n  }, [loading]);\r\n\r\n  function getAllTourList() {\r\n    dispatch(\r\n      listAllTourLeadClients({\r\n        fields: \"*,leads.*,leads.home.*,leads.home.rooms.*\",\r\n        deep: listFilter,\r\n      })\r\n    );\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (tourList.length > 0) {\r\n      homebudget(tourList[0].leads);\r\n    }\r\n  }, [tourList]);\r\n\r\n\r\n  function callback(key) {\r\n\r\n    setTourState(key);\r\n    setListFilter({});\r\n    dispatch(setLeadClientListLoading(true));\r\n    setFilterDropdownValue('');\r\n\r\n  }\r\n\r\n  function switchViewHandler(value) {\r\n    setSwitchView(value);\r\n  }\r\n\r\n  function onListingFilterChange(filteredValue) {\r\n    const filterValue = filteredValue\r\n      ? {\r\n        leads: {\r\n          _filter: {\r\n            home: { care_offered: { _contains: filteredValue } },\r\n          },\r\n        },\r\n      }\r\n      : {};\r\n    setListFilter(filterValue);\r\n    setFilterDropdownValue(filteredValue);\r\n    dispatch(setLeadClientListLoading(true));\r\n  }\r\n\r\n\r\n  const getMaxRoomCost = (rooms) => {\r\n    if (rooms.length) {\r\n      return Math.max.apply(\r\n        null,\r\n        rooms.length\r\n          ? rooms.map(function (room) {\r\n            return room.base_rate ? room.base_rate : 0;\r\n          })\r\n          : [0]\r\n      );\r\n    } else {\r\n      return 0;\r\n    }\r\n  };\r\n\r\n  const getMinRoomCost = (rooms) => {\r\n    if (rooms.length) {\r\n      return Math.min.apply(\r\n        null,\r\n        rooms.map(function (room) {\r\n          return room.base_rate ? room.base_rate : 0;\r\n        })\r\n      );\r\n    } else {\r\n      return 0;\r\n    }\r\n  };\r\n\r\n\r\n\r\n\r\n  const homebudget = (list) => {\r\n    list.forEach((Item, index) => {\r\n      if (Item.home) {\r\n        Item.max_budget = getMaxRoomCost(Item.home.rooms);\r\n        Item.min_budget = getMinRoomCost(Item.home.rooms);\r\n      }\r\n\r\n    });\r\n    setLeadsConfig(list);\r\n  };\r\n\r\n  const handleRateChange = (value) => {\r\n    if (value == \"low_to_high\") {\r\n      let NewHomes = leadsConfig.sort(function (a, b) {\r\n        return a.min_budget - b.min_budget;\r\n      });\r\n      setLeadsConfig([...NewHomes]);\r\n    }\r\n    if (value == \"high_to_low\") {\r\n      let NewHomes = leadsConfig.sort(function (a, b) {\r\n        return b.max_budget - a.max_budget;\r\n      });\r\n      setLeadsConfig([...NewHomes]);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Breadcrumb>\r\n        <Breadcrumb.Item>Home</Breadcrumb.Item>\r\n        <Breadcrumb.Item>Tours</Breadcrumb.Item>\r\n      </Breadcrumb>\r\n      <div>\r\n        <Tabs defaultActiveKey=\"scheduled\" onChange={callback}>\r\n          <TabPane tab=\"SCHEDULED\" key=\"scheduled\">\r\n            {loading ? (\r\n              <Skeleton />\r\n            ) : (\r\n              <React.Fragment>\r\n\r\n\r\n                <FilterViewCommunity\r\n                  onSetSwitchView={switchViewHandler}\r\n                  defaultSwitchView={switchView}\r\n                  listFilterChange={onListingFilterChange}\r\n                  defaultFilterListValue={filterDropdownValue}\r\n                  handleRateChange={handleRateChange}\r\n                />\r\n\r\n                {switchView ? (\r\n                  <Row gutter={16}>\r\n                    {tourList && tourList.length > 0\r\n                      ? tourList.map((item, index) => (\r\n                        <React.Fragment key={index}>\r\n                          {leadsConfig.length > 0 &&\r\n                            leadsConfig.map((lead) => (\r\n                              <Col xs={24} md={8} lg={8} key={lead.id}>\r\n                                {/* {lead.home.name == \"micro\" ? <>\r\n\r\n                                  {console.log(new Date(lead.scheduled_date).getTime(), 'lead')}\r\n                                  {console.log(new Date().getTime(), 'lead after')}\r\n                                </> : \"\"} */}\r\n                                {lead.tour_status === 'scheduled' && (lead.approval == \"accepted\" || lead.approval == \"pending\") && ((new Date(lead.scheduled_date).getTime() + (-timeZone * 60000)) > new Date().getTime()) &&\r\n                                  lead.home !== null && (\r\n                                    <CardViewTour\r\n                                      leadClientId={item.id}\r\n                                      leadClientName={item.name}\r\n                                      leadClientPhone={item.cell}\r\n                                      // leadID={lead.id}\r\n                                      lead={lead}\r\n                                      homeID={lead.home.id}\r\n                                      name={lead.home.name}\r\n                                      address={lead.home.address_line_1}\r\n                                      approval={lead.approval}\r\n                                      coverImage={\r\n                                        lead.home.image &&\r\n                                        lead.home.image\r\n                                      }\r\n                                      liked={lead.is_liked}\r\n                                      notes={lead.notes}\r\n                                      rooms={lead.home.rooms}\r\n                                    />\r\n                                  )}\r\n                              </Col>\r\n                            ))}\r\n                        </React.Fragment>\r\n                      ))\r\n                      : null}\r\n                  </Row>\r\n                ) : (\r\n                  <div>\r\n                    {tourList && tourList.length > 0 ? (\r\n                      <React.Fragment>\r\n                        <MapViewTour lead={leadsConfig} tourType={tourState} />\r\n                      </React.Fragment>\r\n                    ) : null}\r\n                  </div>\r\n                )}\r\n              </React.Fragment>\r\n            )}\r\n          </TabPane>\r\n          <TabPane tab=\"COMPLETED\" key=\"completed\">\r\n            {loading ? (\r\n              <Skeleton />\r\n            ) : (\r\n              <>\r\n                <FilterViewCommunity\r\n                  onSetSwitchView={switchViewHandler}\r\n                  defaultSwitchView={switchView}\r\n                  listFilterChange={onListingFilterChange}\r\n                  defaultFilterListValue={filterDropdownValue}\r\n                  handleRateChange={handleRateChange}\r\n                />\r\n                {switchView ? (\r\n                  <Row gutter={16}>\r\n                    {tourList && tourList.length > 0\r\n                      ? tourList.map((item, index) => (\r\n                        <React.Fragment key={index}>\r\n                          {leadsConfig.length > 0 &&\r\n                            leadsConfig.map((lead) => (\r\n                              <Col xs={24} md={8} lg={8} key={lead.id}>\r\n                                {lead.tour_status === 'scheduled' && (lead.approval == \"accepted\" || lead.approval == \"pending\") && ((new Date(lead.scheduled_date).getTime() + (-timeZone * 60000)) < new Date().getTime()) &&\r\n                                  lead.home !== null && (\r\n                                    <CardViewTour\r\n                                      leadClientId={item.id}\r\n                                      leadClientName={item.name}\r\n                                      leadClientPhone={item.cell}\r\n                                      // leadID={lead.id}\r\n                                      lead={lead}\r\n                                      homeID={lead.home.id}\r\n                                      name={lead.home.name}\r\n                                      address={lead.home.address_line_1}\r\n                                      approval={lead.approval}\r\n                                      coverImage={\r\n                                        lead.home.image &&\r\n                                        lead.home.image\r\n                                      }\r\n                                      liked={lead.is_liked}\r\n                                      notes={lead.notes}\r\n                                      rooms={lead.home.rooms}\r\n                                    />\r\n                                  )}\r\n                              </Col>\r\n                            ))}\r\n                        </React.Fragment>\r\n                      ))\r\n                      : null}\r\n                  </Row>\r\n                ) : (\r\n                  <div>\r\n                    {tourList && tourList.length > 0 ? (\r\n                      <React.Fragment>\r\n                        <MapViewTour lead={leadsConfig} tourType={tourState} />\r\n                      </React.Fragment>\r\n                    ) : null}\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n          </TabPane>\r\n        </Tabs>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default ListTour;\r\n"]},"metadata":{},"sourceType":"module"}